/* public/css/print.css - Version Finale Robuste (Portrait & Paysage) */
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Roboto+Mono:wght@700&display=swap');
@import url('https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css');

:root {
    --grid-gap: 4mm;
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: #f0f0f0;
    margin: 0;
}

.page-container {
    margin: 1rem auto;
    padding: 10mm;
    background-color: white;
    /* Largeur A4 pour la prévisualisation à l'écran */
    width: 210mm;
    min-height: calc(297mm - 2 * 10mm);
    box-sizing: border-box;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

/* --- En-tête de la page --- */
.print-header {
    text-align: center;
    margin-bottom: 2rem;
    border-bottom: 1px solid #ccc;
    padding-bottom: 1rem;
    page-break-after: avoid;
}

.page-title { font-size: 18pt; font-weight: bold; margin: 0; }
.print-meta { margin-top: 0.5rem; color: #666; font-size: 9pt; display: flex; justify-content: space-between; align-items: center; }
.print-meta button { padding: 8px 12px; border: 1px solid #ccc; background-color: #f0f0f0; border-radius: 4px; cursor: pointer; }

/* --- Groupes par univers --- */
.univers-group { page-break-before: always; }
.univers-group:first-child { page-break-before: auto; }
.univers-title { font-size: 14pt; font-weight: bold; border-bottom: 1px solid #999; padding-bottom: 8px; margin-bottom: 1rem; page-break-after: avoid; }

/* --- Grille et Styles des étiquettes --- */
.print-grid { display: grid; gap: var(--grid-gap); }
.print-item { border: 1px solid #333; padding: 2mm; box-sizing: border-box; display: flex; overflow: hidden; page-break-inside: avoid; background: white; }

/* Modèle 1: Classique (QR à gauche) */
.template-qr-left { height: 40mm; flex-direction: row; align-items: center; gap: 3mm; }
.template-qr-left .print-qr-code { flex: 0 0 35mm; }
.template-qr-left .print-details { flex-grow: 1; width: calc(100% - 35mm - 3mm); }
.template-qr-left .print-code { font-size: 16pt; }
.template-qr-left .print-libelle { font-size: 11pt; }

/* Modèle 2: Vertical (QR en haut) */
.template-qr-top { height: 55mm; flex-direction: column; text-align: center; gap: 2mm; }
.template-qr-top .print-qr-code { flex: 0 0 35mm; }
.template-qr-top .print-details { flex-grow: 1; width: 100%; }
.template-qr-top .print-code { font-size: 14pt; }
.template-qr-top .print-libelle { font-size: 10pt; }

/* Modèle 3: Compact */
.template-compact { height: 25mm; flex-direction: row; align-items: center; gap: 3mm; }
.template-compact .print-qr-code { flex: 0 0 20mm; }
.template-compact .print-details { flex-grow: 1; width: calc(100% - 20mm - 3mm); }
.template-compact .print-code { font-size: 12pt; }
.template-compact .print-libelle { font-size: 9pt; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

/* --- Styles communs aux éléments internes --- */
.print-qr-code { height: 100%; display: flex; align-items: center; justify-content: center; }
.print-qr-code canvas { max-width: 100%; max-height: 100%; object-fit: contain; }
.print-details { display: flex; flex-direction: column; justify-content: center; gap: 1mm; font-size: 10pt; word-break: break-word; overflow: hidden; }
.print-code { font-family: 'Roboto Mono', monospace; font-weight: 700; color: #000; }
.print-libelle { font-weight: bold; }
.print-univers, .print-comment { font-size: 9pt; color: #444; }
.print-comment { font-style: italic; }

/* --- STYLES SPÉCIFIQUES À L'IMPRESSION --- */
@media print {
    * { box-sizing: border-box; }
    body { background-color: white; }
    .no-print { display: none !important; }
    .page-container {
        margin: 0;
        padding: 0; /* Les marges sont gérées par les paramètres de l'imprimante */
        width: 100%;
        min-height: 100%;
        box-shadow: none;
        border: none;
    }

    /* --- Styles pour l'orientation PORTRAIT --- */
    @page {
        size: A4 portrait;
        margin: 10mm;
    }
    body.template-qr-left .print-grid,
    body.template-compact .print-grid {
        grid-template-columns: repeat(2, 1fr); /* 2 colonnes en portrait */
    }
    body.template-qr-top .print-grid {
        grid-template-columns: repeat(3, 1fr); /* 3 colonnes en portrait */
    }

    /* --- Styles pour l'orientation PAYSAGE --- */
    @media (orientation: landscape) {
        @page {
            size: A4 landscape;
            margin: 10mm;
        }
        body.template-qr-left .print-grid,
        body.template-compact .print-grid {
            grid-template-columns: repeat(3, 1fr); /* Passe à 3 colonnes en paysage */
        }
        body.template-qr-top .print-grid {
            grid-template-columns: repeat(4, 1fr); /* Passe à 4 colonnes en paysage */
        }
    }
}
